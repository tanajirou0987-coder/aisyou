# 要件定義書
# 男女相性診断アプリ

**バージョン:** 1.0  
**作成日:** 2025年10月14日  
**最終更新日:** 2025年10月14日

***

## 1. プロジェクト概要

### 1.1 開発目的

男女の恋愛における相性を心理学理論に基づいて診断し、関係性に応じた具体的なアドバイスを提供するWebアプリケーションを開発する。本格的で真剣な雰囲気を重視し、科学的根拠のある診断結果により、ユーザーの恋愛関係の理解と改善をサポートすることを目的とする。

### 1.2 開発背景

既存の相性診断アプリの多くは、エンターテインメント性に偏っており、科学的根拠や実用性に欠ける傾向がある。本アプリは、心理学者ジョン・リーのラブスタイル類型論をベースにした20タイプ分類を採用し、関係ステージに応じた詳細なアドバイスを提供することで、真剣に相性を知りたいユーザーのニーズに応える。

### 1.3 ターゲットユーザー

- **主要ターゲット:** 20代〜30代の男女
- **利用シーン:** 
  - カップルで真剣に相性を確認したい
  - 合コンや友人との集まりで複数人で診断を楽しみたい
  - 気になる人との相性を事前に知りたい
- **ユーザー特性:** 科学的根拠のある診断を求める、本格的な内容を好む

### 1.4 期待される効果

- ユーザーが自分と相手の恋愛スタイルを理解できる
- 関係ステージに応じた具体的なアドバイスにより、関係改善に役立つ
- 複数人での診断により、グループ内の相性が可視化される
- 心理学理論に基づく診断により、信頼性と満足度が向上する

### 1.5 専門用語の定義

| 用語 | 定義 |
|------|------|
| ラブスタイル類型論 | 心理学者ジョン・リーが提唱した、恋愛スタイルを6つに分類する理論（エロス・ルダス・ストルゲ・プラグマ・マニア・アガペ） |
| 複合タイプ | 主要タイプと副次タイプの組み合わせによる分類方法 |
| 関係ステージ | 付き合う前／付き合っている（交際期間別）の関係性の段階 |
| 相性スコア | 2人の恋愛スタイルの組み合わせから算出される0〜100点の相性指標 |

***

## 2. システム要件（業務要件）

### 2.1 システム化の範囲

**システム化する範囲:**
- 診断質問の提示と回答収集
- 恋愛スタイルタイプの判定（20タイプ×男女）
- 相性スコアの算出（全組み合わせ）
- 関係ステージ別の詳細診断結果の表示
- 複数人診断の管理と結果表示

**システム化しない範囲:**
- ユーザー登録・ログイン機能
- 診断履歴の保存機能
- SNSシェア機能
- 結果のPDF保存機能

### 2.2 利用フロー

#### 一つの端末を回すモード

1. アプリにアクセス
2. 参加人数を選択（2〜6人）
3. 各参加者の名前と性別を入力
4. 関係性を選択（付き合う前 or 付き合っている）
   - 「付き合っている」を選択した場合、交際期間を追加選択
5. 1人目が診断質問（45問）に回答
6. 「次の人へ」ボタンをタップ
7. 2人目以降も同様に回答
8. 全員の回答完了後、相性マトリックス表を表示
9. 気になる組み合わせをタップして詳細結果を閲覧

#### 複数端末モード（オプション）

1. 各ユーザーが自分の端末でアプリにアクセス
2. グループコードを生成または入力
3. 各自で診断質問に回答
4. 全員の回答完了後、結果を共有

### 2.3 システム構成図

```
[ユーザー端末（スマートフォン/タブレット）]
           ↓
[Webブラウザ]
           ↓
[フロントエンド（React/Next.js等）]
           ↓
[バックエンド/ロジック層]
 - 診断ロジック
 - 相性算出エンジン
 - コンテンツ生成ロジック
           ↓
[データ層]
 - 質問データ
 - タイプ定義データ
 - 相性マトリックスデータ
 - コンテンツテンプレートデータ
```

***

## 3. 機能要件

### 3.1 診断開始画面

| 機能ID | 機能名 | 詳細 | 優先度 |
|--------|--------|------|--------|
| F-001 | 参加人数選択 | 2〜6人から選択可能 | 高 |
| F-002 | 参加者情報入力 | 各参加者の名前（ニックネーム可）と性別（男性/女性）を入力 | 高 |
| F-003 | 関係性選択 | 「付き合う前」「付き合っている」の2択を表示 | 高 |
| F-004 | 交際期間選択 | 「付き合っている」選択時のみ表示。選択肢：「3ヶ月未満」「3ヶ月〜1年未満」「1年〜3年未満」「3年以上」 | 高 |
| F-005 | 入力バリデーション | 必須項目の入力チェック、同じ名前の重複チェック | 高 |

### 3.2 診断質問画面

| 機能ID | 機能名 | 詳細 | 優先度 |
|--------|--------|------|--------|
| F-006 | 質問表示 | 45問の質問を1問ずつ表示 | 高 |
| F-007 | 回答選択 | 5段階評価（全く当てはまらない／あまり当てはまらない／どちらともいえない／やや当てはまる／非常に当てはまる）| 高 |
| F-008 | プログレスバー | 現在の回答進捗を表示（例：15/45） | 中 |
| F-009 | 戻るボタン | 前の質問に戻って回答を修正可能 | 中 |
| F-010 | 現在の回答者表示 | 画面上部に「○○さんの診断」と表示 | 高 |
| F-011 | 次の人へ遷移 | 全質問回答後、「次の人へ」ボタンを表示し、次の参加者の診断に遷移 | 高 |
| F-012 | 回答データ保存 | 各参加者の回答をセッションまたはローカルストレージに一時保存 | 高 |

### 3.3 質問内容

| 機能ID | 機能名 | 詳細 | 優先度 |
|--------|--------|------|--------|
| F-013 | エロス測定質問 | 8問（情熱的・ロマンティック・外見重視・理想追求を測定） | 高 |
| F-014 | ルダス測定質問 | 7問（遊び心・束縛を嫌う・複数恋愛・ゲーム感覚を測定） | 高 |
| F-015 | ストルゲ測定質問 | 8問（友情ベース・ゆっくり発展・安定志向・穏やかを測定） | 高 |
| F-016 | プラグマ測定質問 | 7問（現実的・条件重視・計画的・長期視点を測定） | 高 |
| F-017 | マニア測定質問 | 7問（依存的・嫉妬深い・感情起伏・夢中を測定） | 高 |
| F-018 | アガペ測定質問 | 8問（献身的・無償の愛・相手優先・自己犠牲を測定） | 高 |

### 3.4 タイプ判定ロジック

| 機能ID | 機能名 | 詳細 | 優先度 |
|--------|--------|------|--------|
| F-019 | 回答スコア算出 | 各恋愛スタイル（6種類）の点数を算出（5段階評価を点数化）| 高 |
| F-020 | 主要タイプ判定 | 最も点数が高い恋愛スタイルを主要タイプとして判定 | 高 |
| F-021 | 副次タイプ判定 | 2番目に点数が高い恋愛スタイルを副次タイプとして判定 | 高 |
| F-022 | 20タイプ分類 | 主要タイプと副次タイプの組み合わせ、または純粋型、バランス型として20タイプのいずれかに分類 | 高 |
| F-023 | 男女別タイプデータベース | 男性用20タイプ、女性用20タイプのデータを管理 | 高 |

### 3.5 相性スコア算出

| 機能ID | 機能名 | 詳細 | 優先度 |
|--------|--------|------|--------|
| F-024 | 相性マトリックス参照 | 男性タイプ×女性タイプの相性スコア（0〜100点）を事前定義されたマトリックスから取得 | 高 |
| F-025 | 全組み合わせ算出 | 参加者全員の男女の組み合わせについて相性スコアを算出（n人の場合、最大n(n-1)/2組） | 高 |
| F-026 | 最高相性の特定 | 全組み合わせの中で最も相性スコアが高い組み合わせを特定 | 中 |

### 3.6 結果一覧画面

| 機能ID | 機能名 | 詳細 | 優先度 |
|--------|--------|------|--------|
| F-027 | 相性マトリックス表示 | 参加者全員の相性スコアを表形式で表示（行×列に各参加者、交差点にスコア表示）| 高 |
| F-028 | スコア色分け | 相性スコアを色で視覚化（高スコア：赤系、中スコア：黄系、低スコア：青系など）| 中 |
| F-029 | 最高相性ハイライト | 最高相性の組み合わせに特別なマークやエフェクトを表示 | 中 |
| F-030 | 組み合わせ詳細リンク | 各セル（組み合わせ）をタップすると詳細結果画面に遷移 | 高 |
| F-031 | 全体の傾向コメント | 「このグループは全体的に相性が良いです」などの総評を表示 | 低 |

### 3.7 詳細結果画面

| 機能ID | 機能名 | 詳細 | 優先度 |
|--------|--------|------|--------|
| F-032 | 総合相性スコア表示 | 0〜100点のスコアを大きく表示、ビジュアルメーター（ハート型、サークル型など）で視覚化 | 高 |
| F-033 | キャッチコピー表示 | 「情熱的で刺激的な関係」などの一言キャッチコピーを表示 | 中 |
| F-034 | 二人のタイプ解説 | 300〜400字の総合解説文を表示 | 高 |
| F-035 | 相性の強み | 200〜300字の強みに関する解説文を表示 | 高 |
| F-036 | シーン別相性分析 | 「デート中」「喧嘩・対立時」「日常生活」「将来設計」の4シーンについて、各150〜200字の解説を表示 | 高 |
| F-037 | 未来予想図タイムライン | 関係ステージに応じて内容を変更。「付き合っている」場合は交際期間に応じた内容を表示 | 高 |
| F-038 | 相手を理解するヒント | 「彼/彼女が喜ぶ言葉・行動TOP3」「お互いのNG行動」をそれぞれ解説付きで表示 | 高 |
| F-039 | アクションプラン | 300〜400字の具体的な行動提案を表示 | 高 |
| F-040 | 課題と改善ポイント | 300〜400字の注意点と改善策を表示 | 高 |
| F-041 | エンタメ要素 | 「二人を動物で例えると」「友達から見た二人」「二人のカップルタイプ」を各100〜150字で表示 | 中 |
| F-042 | 一覧に戻るボタン | 結果一覧画面に戻るボタンを設置 | 高 |

### 3.8 関係ステージ別コンテンツ切り替え

| 機能ID | 機能名 | 詳細 | 優先度 |
|--------|--------|------|--------|
| F-043 | 付き合う前コンテンツ | 「距離の縮め方」「初デートの提案」「告白のタイミング」にフォーカスした内容を表示 | 高 |
| F-044 | 付き合っている（3ヶ月未満）コンテンツ | 「連絡頻度」「デート頻度」「この時期の注意点」にフォーカスした内容を表示 | 高 |
| F-045 | 付き合っている（3ヶ月〜1年未満）コンテンツ | 「安定期の過ごし方」「関係深化」にフォーカスした内容を表示 | 高 |
| F-046 | 付き合っている（1年〜3年未満）コンテンツ | 「マンネリ対策」「将来設計」にフォーカスした内容を表示 | 高 |
| F-047 | 付き合っている（3年以上）コンテンツ | 「長期的な関係維持」「結婚や家族計画」にフォーカスした内容を表示 | 高 |

### 3.9 レスポンシブ対応

| 機能ID | 機能名 | 詳細 | 優先度 |
|--------|--------|------|--------|
| F-048 | スマートフォン最適化 | スマートフォン画面サイズでの表示・操作を最適化 | 高 |
| F-049 | タブレット対応 | タブレット画面サイズでの表示に対応 | 中 |
| F-050 | PC表示対応 | PC画面サイズでも閲覧可能（優先度は低い）| 低 |

***

## 4. 非機能要件

### 4.1 性能要件

| 項目 | 要件 | 優先度 |
|------|------|--------|
| 画面表示速度 | 各画面の初期表示は3秒以内 | 高 |
| 診断結果算出時間 | 全参加者の回答完了後、5秒以内に結果画面を表示 | 高 |
| 同時利用者数 | 初期フェーズでは100セッション同時接続に対応 | 中 |
| データ処理 | 6人×45問の回答データを1秒以内に処理・判定 | 高 |

### 4.2 ユーザビリティ要件

| 項目 | 要件 | 優先度 |
|------|------|--------|
| 操作性 | 直感的な操作が可能で、マニュアルなしで利用できること | 高 |
| フォント | 読みやすく信頼感のあるフォントを使用（ヒラギノ角ゴ、Noto Sans JPなど）| 中 |
| 文字サイズ | 本文は最低14px以上、見出しは18px以上で可読性を確保 | 高 |
| タップ領域 | ボタンやリンクのタップ可能領域は最低44×44px以上 | 高 |
| エラー表示 | 入力エラー時は分かりやすいメッセージを赤字で表示 | 高 |
| ローディング表示 | 処理中はローディングインジケーターを表示 | 高 |

### 4.3 デザイン要件

| 項目 | 要件 | 優先度 |
|------|------|--------|
| デザインコンセプト | 本格的・真剣な雰囲気を重視。落ち着いた色調で洗練された印象 | 高 |
| カラーパレット | 深いブルー、パープル、ゴールドなどの落ち着いた色を基調とする | 高 |
| アニメーション | 控えめで品のある動きに留める。過度なエフェクトは避ける | 中 |
| 画像・イラスト | 必要最低限に留め、テキストベースの情報提示を重視 | 中 |
| 心理学的根拠の明示 | 「ラブスタイル類型論に基づく」「科学的根拠のある診断」などを画面上に表記 | 高 |

### 4.4 セキュリティ要件

| 項目 | 要件 | 優先度 |
|------|------|--------|
| データ保存 | 個人情報はサーバーに保存せず、セッションまたはローカルストレージで一時保持 | 高 |
| データ削除 | 診断終了後、一定時間経過後に自動的にセッションデータを削除 | 中 |
| HTTPS通信 | 通信はHTTPSで暗号化 | 高 |
| XSS対策 | ユーザー入力のサニタイズ処理を実施 | 高 |

### 4.5 保守運用要件

| 項目 | 要件 | 優先度 |
|------|------|--------|
| コンテンツ更新 | 診断結果の解説文を管理画面または設定ファイルで更新可能にする | 中 |
| 質問内容の変更 | 診断質問の内容を容易に変更・追加できる設計にする | 中 |
| エラーログ | システムエラー発生時はログを記録し、管理者が確認できるようにする | 中 |
| バックアップ | データベース（質問・タイプ定義・相性マトリックス）の定期バックアップ | 低 |

### 4.6 互換性要件

| 項目 | 要件 | 優先度 |
|------|------|--------|
| ブラウザ対応 | Chrome、Safari、Firefox、Edgeの最新版に対応 | 高 |
| OS対応 | iOS 14以降、Android 10以降に対応 | 高 |
| 画面サイズ | スマートフォン（360px〜）、タブレット（768px〜）に対応 | 高 |

### 4.7 アクセシビリティ要件

| 項目 | 要件 | 優先度 |
|------|------|--------|
| 色覚多様性 | 色だけに依存しない情報表示（スコア表示に数値も併記など）| 中 |
| コントラスト | WCAG 2.1のAA基準を満たすコントラスト比を確保 | 中 |
| フォーカス表示 | キーボード操作時のフォーカス位置を明示 | 低 |

***

## 5. データ要件

### 5.1 データ構造

#### 参加者データ

```
{
  "participants": [
    {
      "id": 1,
      "name": "太郎",
      "gender": "male",
      "answers": [1, 3, 5, 2, 4, ...], // 45個の回答（1〜5の整数）
      "typeResult": {
        "mainType": "eros",
        "subType": "pragma",
        "typeId": "M-01" // 男性20タイプのID
      }
    },
    ...
  ]
}
```

#### 関係性データ

```
{
  "relationship": {
    "status": "dating", // "before_dating" or "dating"
    "duration": "3months" // "less_than_3m", "3m_to_1y", "1y_to_3y", "over_3y"
  }
}
```

#### 相性結果データ

```
{
  "compatibilityResults": [
    {
      "person1": "太郎",
      "person2": "花子",
      "score": 85,
      "typeCombo": "M-01_F-05"
    },
    ...
  ]
}
```

### 5.2 マスターデータ

#### 質問マスター
- 45問の質問文
- 各質問が測定する恋愛スタイル（エロス、ルダスなど）
- 質問の表示順序

#### タイプ定義マスター
- 男性20タイプの定義（タイプID、名称、主要タイプ、副次タイプ）
- 女性20タイプの定義（同上）
- 各タイプの特徴説明文

#### 相性マトリックスマスター
- 男性20タイプ×女性20タイプ=400通りの相性スコア（0〜100点）
- 各組み合わせの相性に関する基礎情報

#### コンテンツテンプレートマスター
- 400通り×5関係ステージ=2,000パターンのコンテンツ
- 各パターンに対する詳細結果画面の全セクションの文章（総合診断、シーン別分析、未来予想図など）

***

## 6. 画面遷移図

```
[トップ画面]
    ↓
[参加人数・情報入力画面]
    ↓
[関係性選択画面]
    ↓
[診断質問画面（1人目）]
    ↓
[診断質問画面（2人目）]
    ↓
    ...
    ↓
[診断質問画面（n人目）]
    ↓
[処理中（ローディング）]
    ↓
[結果一覧画面（相性マトリックス表示）]
    ↓
[詳細結果画面（特定の組み合わせ）]
    ↓
[結果一覧画面に戻る]
```

***

## 7. 制約事項・前提条件

### 7.1 制約事項

- 診断結果はセッション単位で管理し、サーバーに永続的に保存しない
- ユーザー登録・ログイン機能は実装しない
- 診断履歴の保存機能は実装しない
- 複数端末モードは初期リリースではオプション扱い

### 7.2 前提条件

- ユーザーはスマートフォンまたはタブレットからアクセスする
- ユーザーはインターネット接続環境にある
- 参加者は2名以上6名以下とする
- 診断は1セッションあたり30分以内に完了することを想定

***

## 8. 開発スケジュール（想定）

| フェーズ | 期間 | 内容 |
|---------|------|------|
| 要件定義 | 完了 | 本ドキュメント作成 |
| 基本設計 | 2週間 | 画面設計、データベース設計、API設計 |
| 詳細設計 | 2週間 | 各機能の詳細仕様、ロジック設計 |
| 開発 | 6週間 | フロントエンド・バックエンド開発 |
| テスト | 2週間 | 単体テスト、結合テスト、ユーザビリティテスト |
| リリース準備 | 1週間 | 本番環境構築、最終確認 |
| **合計** | **約13週間** | |

***

## 9. 今後の検討事項

### 9.1 オプション機能（優先度：低）

- 複数端末モード（QRコードまたは共有コードでの結果統合）
- 診断結果のPDF保存機能
- 比較機能（他の組み合わせとの相性比較）
- 成長トラッキング（同じカップルが再診断した場合の変化表示）

### 9.2 将来的な拡張案

- カップル専用モード（2人専用の深掘り診断）
- タイプ別アドバイスの定期配信機能
- ユーザーコミュニティ機能（同じタイプの人との交流）

***

## 10. 実装状況

### 10.1 完了済み機能

- ✅ 45問の質問作成（ラブスタイル類型論ベース）
- ✅ 男性20タイプ、女性20タイプの定義
- ✅ タイプ判定ロジック（主要タイプ×副次タイプ）
- ✅ 相性マトリックス算出ロジック
- ✅ 関係ステージ選択機能（付き合う前／交際期間別）

### 10.2 実装中

- 🔄 詳細結果画面のコンテンツ生成ロジック
- 🔄 結果一覧画面（相性マトリックス表示）
- 🔄 UIデザインの本格化（深いブルー・パープル・ゴールド）

### 10.3 未実装

- ⏳ 関係ステージ別コンテンツの動的生成
- ⏳ シーン別相性分析
- ⏳ 未来予想図タイムライン
- ⏳ アクションプラン生成

***

**以上**


